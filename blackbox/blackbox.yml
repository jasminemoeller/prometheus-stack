modules:
  # HTTP over TLS, expect 2xx, gather SSL information
  http_2xx:
    prober: http
    timeout: 10s
    http:
      method: GET
      valid_status_codes: []        # Default is 2xx; empty = "2xx is OK"
      fail_if_not_ssl: true         # Enforce HTTPS
      preferred_ip_protocol: "ip4"

  # IMAP with STARTTLS (checks basic connectivity and TLS handshake)
  imap_starttls:
    prober: tcp
    timeout: 10s
    tcp:
      preferred_ip_protocol: "ip4"
      tls: true
      tls_config:
        insecure_skip_verify: false